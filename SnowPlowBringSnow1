-- Wait for the player's character to load
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()

-- Table to store original positions of Snow1 parts
local originalPositions = {}
local isSnowBeingBrought = false
local snowLoop

-- Function to find all parts named "Snow1" in the workspace
local function getSnowParts()
    local parts = {}
    for _, part in ipairs(workspace:GetDescendants()) do
        if part:IsA("BasePart") and part.Name == "Snow1" then
            table.insert(parts, part)
            -- Store original positions if not already stored
            if not originalPositions[part] then
                originalPositions[part] = part.CFrame
            end
        end
    end
    return parts
end

-- Function to bring all Snow1 parts to the player's feet
local function bringAllSnowToFeet(snowParts)
    if character then
        local rootPart = character:FindFirstChild("HumanoidRootPart")
        if rootPart then
            for _, snowPart in ipairs(snowParts) do
                if snowPart and snowPart:IsDescendantOf(workspace) then
                    snowPart.CFrame = rootPart.CFrame * CFrame.new(0, -rootPart.Size.Y / 2 - snowPart.Size.Y / 2, 0)
                end
            end
        end
    end
end

-- Function to reset Snow1 parts to their original positions
local function resetSnowParts()
    for snowPart, originalCFrame in pairs(originalPositions) do
        if snowPart and snowPart:IsDescendantOf(workspace) then
            snowPart.CFrame = originalCFrame
        end
    end
end

-- Start or stop the snow loop based on the toggle value
local function toggleSnowBehavior(isEnabled)
    if isEnabled then
        -- Start bringing snow to the player's feet
        isSnowBeingBrought = true
        snowLoop = coroutine.create(function()
            while isSnowBeingBrought do
                local snowParts = getSnowParts()
                if #snowParts > 0 then
                    bringAllSnowToFeet(snowParts)
                else
                    warn("No parts named 'Snow1' found in the workspace!")
                end
                task.wait(2)
            end
        end)
        coroutine.resume(snowLoop)
    else
        -- Stop the loop and reset snow
        isSnowBeingBrought = false
        resetSnowParts()
    end
end
